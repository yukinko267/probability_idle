<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>ç¢ºç‡ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ãƒœã‚¿ãƒ³</title>
  <style>
    body { background:#222; color:#fff; display:flex; justify-content:center; align-items:center; height:100vh; flex-direction:column; font-family:sans-serif; }
    button { padding:1em 2em; font-size:1.2em; border:none; border-radius:8px; cursor:pointer; }
    #result { margin-top:20px; font-size:1.5em; }
    #score { margin-top:10px; font-size:1.2em; color:yellow; }
    #timer { margin-top:5px; font-size:1.2em; color:orange; }
    #level { margin-top:5px; font-size:1.2em; color:aqua; }
  </style>
</head>
<body>
  <h1>ç¢ºç‡ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ãƒœã‚¿ãƒ³</h1>
  <button id="tryBtn">æŠ¼ã™ï¼ï¼ˆæˆåŠŸç¢ºç‡: 1/2ï¼‰</button>
  <div id="result"></div>
  <div id="score">ã‚¹ã‚³ã‚¢: 0</div>
  <div id="level">ãƒ¬ãƒ™ãƒ«: 1</div>
  <div id="timer"></div>

  <script>
    const btn = document.getElementById("tryBtn");
    const result = document.getElementById("result");
    const scoreEl = document.getElementById("score");
    const timerEl = document.getElementById("timer");
    const levelEl = document.getElementById("level");

    let score = 0;
    let canClick = true;
    let countdown = 0;
    let countdownInterval;

    let level = 1;
    let successProb = 0.5; // æœ€åˆã¯1/2

    function updateButton() {
      btn.textContent = `æŠ¼ã™ï¼ï¼ˆæˆåŠŸç¢ºç‡: 1/${1/successProb})`;
      levelEl.textContent = `ãƒ¬ãƒ™ãƒ«: ${level}`;
    }

    updateButton();

    btn.addEventListener("click", () => {
      if(!canClick){
        result.textContent = "âŒ› ã¾ã å¾…ã£ã¦ï¼";
        result.style.color = "orange";
        return;
      }

      // æˆåŠŸåˆ¤å®š
      const success = Math.random() < successProb;
      if(success){
        score++;
        level++;
        successProb /= 2; // æˆåŠŸç¢ºç‡ã‚’åŠåˆ†ã«
        result.textContent = "ğŸ‰ æˆåŠŸï¼ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼";
        result.style.color = "lime";
      } else {
        result.textContent = "ğŸ’€ å¤±æ•—...";
        result.style.color = "red";
      }
      scoreEl.textContent = "ã‚¹ã‚³ã‚¢: " + score;
      updateButton();

      // ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³é–‹å§‹
      canClick = false;
      countdown = 10;
      timerEl.textContent = `æ¬¡ã®ãƒœã‚¿ãƒ³ã¾ã§: ${countdown}s`;

      countdownInterval = setInterval(() => {
        countdown--;
        if(countdown > 0){
          timerEl.textContent = `æ¬¡ã®ãƒœã‚¿ãƒ³ã¾ã§: ${countdown}s`;
        } else {
          clearInterval(countdownInterval);
          timerEl.textContent = "";
          canClick = true;
        }
      }, 1000);
    });
  </script>
</body>
</html>
